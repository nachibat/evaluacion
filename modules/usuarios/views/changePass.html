{% extends '../../template.html' %}

{% block styles %} 
    <style type="text/css">

    </style>
{% endblock %}

{% block content %}
    <div class="row">
        <div class="col-12">
            <h4 id="title"><i class="fa fa-key"></i>&nbsp;{{ pagename }}</h4>
            <br>
        </div>
        <div class="col-lg-4">
            <div class="form-group">
                <label for="claveActual"><b>Clave actual</b></label>
                <input class="form-control" type="password" id="claveActual" placeholder="Clave actual" required autofocus maxlength="20" minlength="6" autocomplete="off">
            </div>
        </div>
        <div class="col-lg-4">
            <div class="form-group">
                <label for="claveNueva"><b>Nueva contraseña</b></label>
                <input class="form-control" type="password" id="claveNueva" placeholder="Clave nueva" required maxlength="20" minlength="6" autocomplete="new-password">
            </div>
        </div>
        <div class="col-lg-4">
            <div class="form-group">
                <label for="claveNueva2"><b>Confirme nueva contraseña</b></label>
                <input class="form-control" type="password" id="claveNueva2"
                placeholder="Confirme nueva clave" required maxlength="20" minlength="6" autocomplete="new-password">
            </div>
        </div>
        <div class="col-12">
            <div style="float: right;">
                <button id="Guardar" onclick="ChangePass()" class="btn btn-round btn-success"><i class="fa fa-save"></i>&nbsp;Guardar</button>
                <a href="/home" class="btn btn-round btn-danger"><i class="fa fa-backward"></i>&nbsp;Volver</a>
            </div>
        </div>
    </div>
{% endblock %}
{% block scripts%}
<script type="text/javascript">
    function ChangePass() {
        Swal.fire({
            title: 'Confirmar',
            text: "Confirme para modificar el usuario",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Aceptar',
            cancelButtonText: 'Cancelar',
        }).then(async result => {
            if (result.value) {
                $("#preloader").show();
                let body = {
                    actual: $("#claveActual").val(),
                    nueva: $("#claveNueva").val(),
                    nuevaConfirm: $("#claveNueva2").val()
                }
                const res = await $.post("/changePass", body);
                $("#preloader").hide();
                Swal.fire({
                    icon: res.type,
                    title: res.title,
                    text: res.text
                }).then(() => {
                    if (res.type == 'success') window.location = "/home";
                });
            }
        });
    };

</script>
{% endblock %}